\clearpage
# Figures


<!-- ====================================================================== --> 
<!-- ******************* Data Used in the Model *************************** --> 
<!-- ====================================================================== --> 

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "data_plot.png"), 
caption = "Summary of data sources used in the base model",
label = 'data-plot')
```	

<!-- ====================================================================== -->  
<!-- ****************** Catches Used in the Model ************************* --> 
<!-- ====================================================================== -->  

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "catch2 landings stacked.png"), 
caption = "Catches by fleet used in the base model",
label = 'catch')
```	


<!-- ====================================================================== -->
<!-- ****************   Commercial Length Samples    ********************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_bubflt1mkt0_page2.png"), 
caption = "Length composition data from the commercial fleet",
label = 'com-len-data')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_data_weighting_TA1.8_CA_S_Commercial.png"), 
caption = "Mean length for commercial fleet with 95 percent confidence intervals",
label = 'mean-com-len-data')
```

<!-- ====================================================================== -->
<!-- **************** Recreational Length Samples    ********************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_bubflt2mkt0_page3.png"), 
caption = "Length composition data from the recreational fleet",
label = 'rec-len-data')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_data_weighting_TA1.8_CA_S_Recreational.png"), 
caption = "Mean length for recreational fleet with 95 percent confidence intervals",
label = 'mean-rec-len-data')
```

<!-- ====================================================================== -->
<!-- ************** NWFSC HKL Index & Length Sample  ********************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey", "plots",  "HL_SurveyExtent_2017_figure_light_wPorts1024_1.jpg"), 
caption = "NWFSC Hook and Line sampling sites where yellow sites indicate locations inside Cowcod Conservation Areas",
label = 'hkl-sites')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey", "plots",  "HKL_Site_Observations.png"), 
caption = "NWFSC Hook and Line sample sites inside and outside the CCA and site with observations of copper rockfish",
label = 'hkl-site-ob')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "hkl_cca_comparison.png"), 
caption = "NWFSC Hook and Line observations by year outside and inside the cowcod conservation area",
label = 'hkl-cca')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey", "plots",  "HKL_Size_by_Depth.png"), 
caption = "Lengths observations by depth in the NWFSC Hook and Line data",
label = 'hkl-len-dep')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_bubflt3mkt0.png"), 
caption = "Length composition data from the NWFSC Hook and Line fleet",
label = 'hkl-len-data')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lendat_data_weighting_TA1.8_NWFSC_HKL.png"), 
caption = "Mean length for NWFSC Hook and Line fleet with 95 percent confidence intervals",
label = 'mean-hkl-len-data')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "index1_cpuedata_NWFSC_HKL.png"), 
caption = "Index of abundance for the NWFSC Hook and Line survey. Lines indicate 95 percent uncertainty interval around index values based on the model assumption of lognormal error. Thicker lines indicate input uncertainty before addition of estimated additional uncertainty parameter",
label = 'hkl-index')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey_indices", "Copp.2019.NFT.1m.ALL",  "Copp.ALL.GAM.Fig.png"), 
caption = "Diangostics for the binomial generalized-linear model",
label = 'hkl-diag')
```

<!-- ====================================================================== -->
<!-- *************************     ROV         **************************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey", "rov",  "copper_socal_open_area.png"), 
caption = "Count of length observations across depths in an open access area",
label = 'rov-open')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_loc, "survey", "rov",  "copper_socal_mpa_area.png"), 
caption = "Count of length observations across depths within a marine protected area",
label = 'rov-mpa')
```

<!-- ====================================================================== -->
<!-- *************************     Biology     **************************** --> 
<!-- ====================================================================== -->


```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "doc_Length_Weight_Source.png"), 
caption = "Comparison of the length-at-weight data from the NWFSC Hook and Line and the NWFSC WCGBT surveys",
label = 'len-weight-survey')
```	

```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "doc_Length_Weight_Sex.png"), 
caption = "Survey length-at-weight data with sex specific estimated fits",
label = 'len-weight')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "South_Len_at_Age.png"), 
caption = "Length-at-age for non-randomly sampled larger fish observed by the NWFSC Hook and Line and WCGBT survey",
label = 'survey-len-at-age-data')
```	


```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "doc_south_Age_by_Sex_Source.png"), 
caption = "Length-at-age for non-randomly sampled larger fish observed by the NWFSC Hook and Line and WCGBT survey and young fish from Lea",
label = 'south-len-at-age-data')
```	

```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "South_Data_Comparison_Len_at_Age.png"), 
caption = "Length-at-age comparisons between survey collected fish south of Pt. Conception and to those observed off the coast of Oregon and Washington",
label = 'len-at-age-comp')
```	

\newpage

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "bio1_sizeatage.png"), 
caption = "Length-at-age in the beginning of the year with the coefficient of variation by age within the model",
label = 'len-age-ss')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "bio6_maturity.png"), 
caption = "Maturity as a function of  length",
label = 'maturity')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "bio9_fecundity_len.png"), 
caption = "Fecundity as a function of length",
label = 'fecundity')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "Length_fraction_female.png"), 
caption = "Fraction female by length across all available data sources",
label = 'len-sex-ratio')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(data_fig_loc, "Age_fraction_female.png"), 
caption = "Fraction female by age across all available data sources",
label = 'age-sex-ratio')
```

<!-- ====================================================================== -->
<!-- *********************  Model Bridging          ********************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
loc = "C:/Assessments/2021/copper_rockfish_2021/models/ca_s_pt_c/_bridge/_plots"
add_figure(
filein = file.path(loc, "Initial_Bridge.png"), 
caption = "Comparison between SS bridge model and the results from the 2013 XDB-SRA model",
label = 'bridge-1')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(loc, "Growth.png"), 
caption = "Adjustment to SS female weight-at-length curve to create a match in stock scale to XDB-SRA",
label = 'bridge-growth')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(loc, "1_bridge_all_compare1_spawnbio.png"), 
caption = "The time series of spawning biomass (or output) for updates to the 2013 model",
label = 'bridge-ssb')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(loc, "1_bridge_all_compare3_Bratio.png"), 
caption = "The time series of fraction unfished for updates to the 2013 model",
label = 'bridge-depl')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(loc, "1_bridge_subset_compare1_spawnbio.png"), 
caption = "The time series of spawning output for the subset of bridge models with the updated fecundity relationship",
label = 'bridge-ssb-2')
```


<!-- ====================================================================== -->
<!-- *********************    Selectivity            ********************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "sel01_multiple_fleets_length1.png"),
caption = "Selectivity at length by fleet",
label = 'selex')
```


<!-- ====================================================================== -->
<!-- *********************    Recruitment            ********************** --> 
<!-- ====================================================================== -->



```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "ts11_Age-0_recruits_(1000s)_with_95_asymptotic_intervals.png"), 
caption = "Estimated time series of age-0 recruits (1000s)",
label = 'recruits')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "recdevs2_withbars.png"), 
caption = "Estimated time series of recruitment deviations",
label = 'rec-devs')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "SR_curve.png"), 
caption = "Stock-recruit curve. Point colors indicate year, with warmer colors indicating earlier years and cooler colors in showing later years",
label = 'bh-curve')
```


<!-- ====================================================================== -->
<!-- ****************** Fit to the Length Data **************************** --> 
<!-- ====================================================================== -->


```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_residsflt1mkt0_page2.png"), 
caption = "Pearson residuals for commercial fleet. Closed bubble are positive residuals (observed > expected) and open bubbles are negative residuals (observed < expected)",
label = 'com-pearson')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_data_weighting_TA1.8_CA_S_Commercial.png"), 
caption = "Mean length for commercial lengths with 95 percent confidence intervals based on current samples sizes",
label = 'com-mean-len-fit')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_residsflt2mkt0_page3.png"), 
caption = "Pearson residuals for recreational fleet. Closed bubble are positive residuals (observed > expected) and open bubbles are negative residuals (observed < expected)",
label = 'rec-pearson')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_data_weighting_TA1.8_CA_S_Recreational.png"), 
caption = "Mean length for recreational lengths with 95 percent confidence intervals based on current samples sizes",
label = 'rec-mean-len-fit')
```


```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_residsflt3mkt0.png"), 
caption = "Pearson residuals for NWFSC Hook and Line survey. Closed bubble are positive residuals (observed > expected) and open bubbles are negative residuals (observed < expected)",
label = 'hkl-pearson')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit_data_weighting_TA1.8_NWFSC_HKL.png"), 
caption = "Mean length for recreational lengths with 95 percent confidence intervals based on current samples sizes",
label = 'hkl-mean-len-fit')
```


```{r, results = 'asis'}

add_figure(
filein = file.path(mod_loc, "plots", "comp_lenfit__aggregated_across_time.png"),
caption = "Aggregated length comps over all years",
label = 'agg-len-fit')
```

<!-- ====================================================================== -->
<!-- **************      NWFSC HKL Index Fit         ********************** --> 
<!-- ====================================================================== -->


```{r, results = 'asis'}

add_figure(
filein = file.path(mod_loc, "plots", "index2_cpuefit_NWFSC_HKL.png"),
caption = "Fit to index data for the NWFSC Hook and Line survey",
label = 'index-fit')
```

<!-- ====================================================================== -->
<!-- ******************      Time Series       **************************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "ts7_Spawning_output_with_95_asymptotic_intervals_intervals.png"), 
caption = "Estimated time series of spawning output",
label = 'ssb')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "ts1_Total_biomass_(mt).png"), 
caption = "Estimated time series of total biomass",
label = 'tot-bio')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "ts9_Fraction_of_unfished_with_95_asymptotic_intervals_intervals.png"), 
caption = "Estimated time series of fraction of unfished spawning output",
label = 'depl')
```


<!-- ====================================================================== -->
<!-- ******************    Reference Points    **************************** --> 
<!-- ====================================================================== -->


```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "SPR2_minusSPRseries.png"), 
caption = "Estimated 1 - relative spawning ratio (SPR) by year",
label = '1-spr')
```

```{r, results = 'asis'}
add_figure(
filein = file.path(mod_loc, "plots", "yield2_yield_curve_with_refpoints.png"), 
caption = "Equilibrium yield curve for the base case model. Values are based on the 2020
fishery selectivity and with steepness fixed at 0.72",
label = 'yield')
```


<!-- ====================================================================== -->
<!-- ******************       Sensitivity     ***************************** --> 
<!-- ====================================================================== -->
  
```{r, echo=FALSE, results='asis'}
#sens_wd = file.path(substr(mod_loc, 1, 57), "_sensitivities", "_plots")
#nm = paste0(substr(mod_loc, 59, 99), "_compare2_spawnbio_uncertainty.png")
#add_figure(
#filein = file.path(sens_wd, nm),
#caption = "Change in estimated spawning output by sensitivity",
#label = 'sens-ssb')
```

```{r, echo=FALSE, results='asis'}
#nm = paste0(substr(mod_loc, 59, 99), "_compare4_Bratio_uncertainty.png")
#add_figure(
#filein = file.path(sens_wd, nm),
#caption = "Change in estimated fraction unfished by sensitivity",
#label = 'sens-depl')
```
<!-- ====================================================================== -->
<!-- ******************       LB-SPR          ***************************** --> 
<!-- ====================================================================== -->

```{r, results = 'asis'}
lbspr = "C:/Assessments/2021/copper_rockfish_2021/models/lbspr"

add_figure(
filein = file.path(lbspr, "Copper_South_LBSPR.png"), 
caption = "LB-SPR yearly estimates of selectivity, the ratio of fishing intensity to natural mortality (F/M), and annual spawner-per-recruit (SPR) values",
label = 'lbspr')
```

\newpage

<!-- ====================================================================== -->
<!-- ******************      Likelihoods      ***************************** --> 
<!-- ====================================================================== -->

```{r, echo=FALSE, results='asis'}
#filein = file.path(general_wd,'figures_likelihoods.Rmd')
#read_child(filein)
```

<!-- ====================================================================== -->
<!-- ******************     Retrospectives    ***************************** --> 
<!-- ====================================================================== -->
  
```{r, echo=FALSE, results='asis'}
filein = file.path(general_wd,'figures_retro.Rmd')
read_child(filein)
```


\newpage